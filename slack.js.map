{"version":3,"sources":["slack.es6"],"names":[],"mappings":"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","file":"slack.js","sourcesContent":["var Slack = require('slack-client');\n//var happy = require('./HappyKnowledge');\nvar Conversation           = require('./SlackConversation.js');\nvar HappinessConversation  = require('./HappinessConversation.js');\nvar RegenbogenConversation = require('./RegenbogenConversation.js');\n\nmodule.exports = (function () {\n  var slackToken = process.env.SlackToken;\n  var autoReconnect = true;\n  var autoMark = true;\n\n  var slack = new Slack(slackToken, autoReconnect, autoMark);\n\n  var slackHooks        = {};\n  var slackConversation = {};\n\n  var getSlackHooks = function(){\n    return slackHooks;\n  };\n\n  slack.on('open', function () {\n    console.log(\"Connected to \" + slack.team.name + \" as \" + slack.self.name);\n  });\n\n  slack.on('message', function (message) {\n    var user;\n    var channel;\n    console.log('Message:' + message);\n    channel = slack.getChannelGroupOrDMByID(message.channel);\n    user    = slack.getUserByID(message.user);\n\n    console.log(\"user: \" + user.name);\n    console.log(\"channel: \" + channel.name);\n\n\n    if(slackConversation[message.user] != undefined){\n      console.log('continue conversation');\n      slackConversation[message.user].process(message);\n      if(slackConversation[message.user].done){\n        delete slackConversation[message.user];\n      }\n    }else {\n\n      var hook = slackHooks[message.text];\n      if (hook != undefined) {\n        console.log('follow hook');\n        hook({'message': message, 'channel': channel, 'user': user});\n      }else{\n        console.log('not sure what to do');\n        channel.send('Hi! How can I help you?');\n        channel.send('Shall we talk about ' + JSON.stringify(getSlackHooks()));\n      }\n    }\n  });\n\n  slackHooks['Hi'] = ((info)=>{\n    slackConversation[info.message.user] = new Conversation(slack, info.channel, info.user);\n  });\n\n  slackHooks['Happy'] = ((info)=>{\n    slackConversation[info.message.user] = new HappinessConversation(slack, info.channel, info.user);\n  });\n\n  slackHooks['Regenbogen'] = ((info)=>{\n    slackConversation[info.message.user] = new RegenbogenConversation(slack, info.channel, info.user);\n  });\n\n  slack.on('error', function (err) {\n    console.log('Error:' + err);\n  });\n\n  slack.login();\n});\n"]}